<!DOCTYPE html><html><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><title>Proud Blog - Redmine 3.2をAmazon Linux(release 2015.09)にインストールしてみた。</title><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><link href="/stylesheets/all.css" rel="stylesheet" /><meta content="1679223382318515" property="fb:app_id" /><meta content="ja_JP" property="og:locale" /><meta content="ja_JP" property="og:locale:alternate" /><meta content="Proud Blog" property="og:site_name" /><meta content="株式会社プラウディットの公式Blogページ" property="og:description" /><meta content="http://blog.proudit.jp/images/OGPimage0708.jpg" property="og:image" /><meta content="image/jpg" property="og:image:type" /><meta content="400" property="og:image:width" /><meta content="300" property="og:image:height" /><meta content="article" property="og:type" /><meta content="Redmine 3.2をAmazon Linux(release 2015.09)にインストールしてみた。" property="og:title" /><meta content="http://blog.proudit.jp/2016/01/18/installation-method-of-redmine.html" property="og:url" /><meta content="2016-01-18T00:00:00Z" property="article:published_time" /><meta content="Redmine" property="article:tag" /><meta content="AmazonLinux" property="article:tag" /><meta content="EC2" property="article:tag" /><meta content="AWS" property="article:tag" /></head><body><header><h1><a href="/">Proud Blog</a></h1><ul class="header-social"><li><a href="https://www.facebook.com/proudit/"><i class="fa fa-facebook-square fa-2x"></i></a></li><li><a href="https://github.com/proudit"><i class="fa fa-github fa-2x"></i></a></li></ul></header><div id="main" role="main"><article><h1>Redmine 3.2をAmazon Linux(release 2015.09)にインストールしてみた。</h1><div class="tag-labels"><small class="tag-label">Redmine</small><small class="tag-label">AmazonLinux</small><small class="tag-label">EC2</small><small class="tag-label">AWS</small></div><br /><p><img class="author" src="/images/authors/kohei.png" /> <i class="fa fa-pencil"></i>Written by    <b>Kohei Yamada</b>　<i class="fa fa-clock-o"></i>Posted on  <b>2016/01/18</b></p><p><div style="width:74px;height:22px;float:left;"><div style="margin-left:-5px"><a href="https://twitter.com/share" class="twitter-share-button"{count} data-via="proudit_inc" data-lang="ja" data-hashtags="proudblog" data-dnt="true">ツイート</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></div></div><div style="width:120px;height:22px;float:left;" id="fb-share-button"></div></p><hr /><br /><p>今回はAmazon Linux(release 2015.09)にRedmine 3.2をインストールする手順をまとめてみました。</p>

<p>方針としてはシンプルにしたいので、できるだけyumやインストール済みのパッケージを利用していきます。</p>

<h1 id="必要なパッケージ等の準備">必要なパッケージ等の準備</h1>

<h4 id="1.開発ツールのインストール">1.開発ツールのインストール</h4>
<pre class="highlight plaintext"><code># yum groupinstall "Development Tools"
</code></pre>

<h4 id="2.rubyのセットアップ">2.rubyのセットアップ</h4>

<p>Amazon Linuxではデフォルトでrubyがインストールされています。今回はインストール済みのを利用し、追加で必要なライブラリのみをインストールします。</p>
<pre class="highlight plaintext"><code># ruby -v
# gem -v
# yum install ruby-devel
# gem install io-console
</code></pre>

<h4 id="3.bundlerのインストール">3.bundlerのインストール</h4>
<pre class="highlight plaintext"><code># gem install bundler --no-rdoc --no-ri
</code></pre>

<h1 id="データベースの準備">データベースの準備</h1>

<h4 id="1.mysqlのインストール">1.MySQLのインストール</h4>

<p>今回のデータベースはRDSを利用するため、クライアントをインストールします。</p>
<pre class="highlight plaintext"><code># yum install mysql mysql-devel
</code></pre>

<h4 id="2.データベースとユーザーの作成">2.データベースとユーザーの作成</h4>
<pre class="highlight plaintext"><code># mysql -h &lt;ホスト名&gt; -u &lt;ユーザー&gt; -p &lt;パスワード&gt;
mysql&gt; create database db_redmine default character set utf8;
mysql&gt; grant all on db_redmine.* to user_redmine@localhost identified by '********';
mysql&gt; flush privileges;
mysql&gt; exit;
</code></pre>

<h1 id="apacheのインストール">apacheのインストール</h1>

<h4 id="1.apacheのインストール">1.apacheのインストール</h4>
<pre class="highlight plaintext"><code># yum install httpd httpd-devel
</code></pre>

<h4 id="2.confファイルの修正---その１">2.confファイルの修正 - その１</h4>

<p>&quot;/etc/httpd/conf/httpd.conf&quot;の以下のコメントアウトを外します。</p>
<pre class="highlight plaintext"><code># vim /etc/httpd/conf/httpd.conf
修正前：# NameVirtualHost *:80 → 修正後：NameVirtualHost *:80

# diff /etc/httpd/conf/httpd.conf /etc/httpd/conf/httpd.conf_org
991c991
&lt; NameVirtualHost *:80
---
&gt; #NameVirtualHost *:80
</code></pre>

<h4 id="3.confファイルの修正---その２">3.confファイルの修正 - その２</h4>

<p>&quot;/etc/httpd/conf.d/redmine.conf&quot;を作成する。</p>
<pre class="highlight plaintext"><code># vim /etc/httpd/conf.d/redmine.conf
</code></pre>

<p>confの内容は適宜修正してください。以下は例となります。</p>
<pre class="highlight plaintext"><code>&lt;VirtualHost *:80&gt;
    ServerName www.example.com

    DocumentRoot /var/www/redmine/public

    ErrorLog  "|/usr/sbin/rotatelogs /var/log/httpd/redmine/error_log.%Y%m%d 86400 540"
    CustomLog "|/usr/sbin/rotatelogs /var/log/httpd/redmine/access_log.%Y%m%d 86400 540" combined

&lt;/VirtualHost&gt;
</code></pre>

<h1 id="redmineの設定">Redmineの設定</h1>

<h4 id="1.必要なパッケージのインストール">1.必要なパッケージのインストール</h4>
<pre class="highlight plaintext"><code># yum -y install openssl-devel readline-devel zlib-devel curl-devel libyaml-devel libffi-devel
</code></pre>

<h4 id="2.imagemagickと日本語フォントのインストール">2.ImageMagickと日本語フォントのインストール</h4>
<pre class="highlight plaintext"><code># yum install ImageMagick ImageMagick-devel ipa-pgothic-fonts
</code></pre>

<h4 id="3.redmineのダウンロード">3.Redmineのダウンロード</h4>

<p>下記のURLからRedmine 3.2のtarball(.tar.gz)をダウンロードします。<br>
<a href="http://www.redmine.org/projects/redmine/wiki/Download">http://www.redmine.org/projects/redmine/wiki/Download</a></p>
<pre class="highlight plaintext"><code># wget http://www.redmine.org/releases/redmine-3.2.0.tar.gz
</code></pre>

<p>ダウンロードしたら展開・配置します。</p>
<pre class="highlight plaintext"><code># tar zxvf redmine-3.2.0.tar.gz
# mv redmine-3.2.0 /var/www/redmine
</code></pre>

<p>また、apacheからアクセスできるようにオーナーの変更をします。</p>
<pre class="highlight plaintext"><code># chown -R apache.apache /var/www/redmine/
</code></pre>

<p>配置したredmineディレクトリ配下のconfigディレクトリに&quot;database.yml&quot;と&quot;configuration.yml&quot;を作成します。</p>
<pre class="highlight plaintext"><code>production:
  adapter: mysql2
  database: db_redmine
  host: &lt;RDSのエンドポイント名&gt;
  username: ユーザー
  password: "パスワード"
  encoding: utf8
</code></pre>
<pre class="highlight plaintext"><code>production:
  email_delivery:
    delivery_method: :smtp
    smtp_settings:
      address: "127.0.0.1"
      port: 25
      domain: 'ドメイン'

  rmagick_font_path: /usr/share/fonts/ipa-gothic/ipag.ttf
</code></pre>

<h4 id="4.redmine用gemパッケージの一括インストール">4.Redmine用Gemパッケージの一括インストール</h4>

<p>bandlerを使ってRedmineが使用するGemを一括でインストールします。</p>
<pre class="highlight plaintext"><code># bundle install --without development test --path vendor/bundle
</code></pre>

<h4 id="5.redmineの初期設定とデータベースのテーブル作成">5.Redmineの初期設定とデータベースのテーブル作成</h4>
<pre class="highlight plaintext"><code># bundle exec rake generate_secret_token
# RAILS_ENV=production bundle exec rake db:migrate
</code></pre>

<h1 id="passengerインストール">passengerインストール</h1>

<h4 id="1.passengerのインストール">1.passengerのインストール</h4>

<p>Railsアプリケーションを実行するためのApacheモジュールであるpassengerをインストールします。</p>
<pre class="highlight plaintext"><code># gem install passenger --no-rdoc --no-ri
</code></pre>

<h4 id="2.apache用モジュールのインストール">2.Apache用モジュールのインストール</h4>
<pre class="highlight plaintext"><code># passenger-install-apache2-module
</code></pre>

<p>以下のコマンドを実行することで、apacheに組み込む設定が確認できます。</p>
<pre class="highlight plaintext"><code># passenger-install-apache2-module --snippet
LoadModule passenger_module /usr/local/share/ruby/gems/2.0/gems/passenger-5.0.22/buildout/apache2/mod_passenger.so
&lt;IfModule mod_passenger.c&gt;
  PassengerRoot /usr/local/share/ruby/gems/2.0/gems/passenger-5.0.22
  PassengerDefaultRuby /usr/bin/ruby2.0
&lt;/IfModule&gt;
</code></pre>

<p>&quot;/etc/httpd/conf.d/&quot;にpassengerの設定ファイルを作成します。</p>
<pre class="highlight plaintext"><code># vim /etc/httpd/conf.d/passenger.conf
</code></pre>
<pre class="highlight plaintext"><code># Passengerの基本設定。
# passenger-install-apache2-module --snippet を実行して表示される設定を使用。
# 環境によって設定値が異なりますので以下の5行はそのまま転記しないでください。
#
LoadModule passenger_module /usr/local/share/ruby/gems/2.0/gems/passenger-5.0.22/buildout/apache2/mod_passenger.so
&lt;IfModule mod_passenger.c&gt;
  PassengerRoot /usr/local/share/ruby/gems/2.0/gems/passenger-5.0.22
  PassengerDefaultRuby /usr/bin/ruby2.0
&lt;/IfModule&gt;

# Passengerが追加するHTTPヘッダを削除するための設定（任意）。
#
Header always unset "X-Powered-By"
Header always unset "X-Rack-Cache"
Header always unset "X-Content-Digest"
Header always unset "X-Runtime"

# 必要に応じてPassengerのチューニングのための設定を追加（任意）。
# 詳しくはPhusion Passenger users guide(http://www.modrails.com/documentation/Users%20guide%20Apache.html)をご覧ください。
PassengerMaxPoolSize 20
PassengerMaxInstancesPerApp 4
PassengerPoolIdleTime 3600
PassengerHighPerformance on
PassengerStatThrottleRate 10
PassengerSpawnMethod smart
RailsAppSpawnerIdleTime 86400
PassengerMaxPreloaderIdleTime 0
</code></pre>

<h4 id="3.apache起動">3.apache起動</h4>

<p>最後にapacheを起動します。</p>
<pre class="highlight plaintext"><code># service httpd start
# chkconfig httpd on
</code></pre>

<p>以上でRedmineのインストールが完了しました。</p>
<br /><br><div style="width:74px;height:22px;float:left;"><div style="margin-left:-5px"><a href="https://twitter.com/share" class="twitter-share-button"{count} data-via="proudit_inc" data-lang="ja" data-hashtags="proudblog" data-dnt="true">ツイート</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script></div></div><div id="fb-share-button2"></div></br><br /><br /></article><aside><fieldset><h2>最近の投稿</h2><ol><li> <i class="fa fa-caret-right"><a href="/2016/07/11/to-expand-the-root-volume-of-centos-hvm-system.html">CentOS HVM方式のルートボリュームを拡張する。</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/07/08/amazakekouza.html">ミネラル甘酒講座</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/07/06/kusuribako.html">13本の薬箱講座</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/07/04/access-to-object-storage-by-s3cmd.html">【IDCFクラウド】s3cmdでオブジェクトストレージへアクセスする</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/29/facebookSARE2.html">OGPの設定</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/27/setting-the-fw-in-the-cloudstack-api.html">【IDCFクラウド】cloudstack-apiでFWの設定をする。</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/24/facebookSARE1.html">facebookへのシェアができない！？〜アプリ設定の方法〜</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/20/associate-a-publicip-to-the-virtualmachine-by-cloudstack-api.html">【IDCFクラウド】cloudstack-apiで仮想マシンにパブリックIPを付与する。</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/15/javascript&amp;jQuery.html">JavaScript、jQueryについてまとめ</a></i></li><li> <i class="fa fa-caret-right"><a href="/2016/06/14/make-virtual-machine-by-cloudstack-api.html">【IDCFクラウド】cloudstack-apiで仮想マシンを作成する。</a></i></li></ol></fieldset><fieldset><h2>投稿者</h2><ol><li> <i class="fa fa-pencil"><a href="/toguma.html">toguma</a></i></li><li> <i class="fa fa-pencil"><a href="/kohei.html">kohei</a></i></li><li> <i class="fa fa-pencil"><a href="/proudcloud.html">proudcloud</a></i></li><li> <i class="fa fa-pencil"><a href="/ayako.html">ayako</a></i></li></ol></fieldset><fieldset><h2>タグ</h2><ol><li> <i class="fa fa-tag"><a href="/tags/aws.html">AWS (15)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/github.html">GitHub (5)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/circleci.html">CircleCI (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/s3.html">S3 (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/lambda.html">lambda (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/cognito.html">cognito (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/waf.html">WAF (3)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/cloudfront.html">CloudFront (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/redmine.html">Redmine (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/amazonlinux.html">AmazonLinux (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/ec2.html">EC2 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/mocloud.html">moCloud (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/hubot.html">Hubot (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/slack.html">Slack (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/jawsdays2016.html">jawsdays2016 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/linux.html">Linux (3)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/vnstat.html">vnstat (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/vnstati.html">vnstati (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/お知らせ.html">お知らせ (5)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/jawsdays.html">JAWSDAYS (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/aws-cli.html">aws-cli (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/macos.html">MacOS (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/docker.html">docker (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/dockerhub.html">DockerHub (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/sts.html">STS (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/お役立ち情報.html">お役立ち情報 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/子育.html">子育 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/日常.html">日常 (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/サーバレス.html">サーバレス (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/非エンジニアから見たインフラの世界.html">非エンジニアから見たインフラの世界 (3)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/s3cmd.html">s3cmd (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/idcf.html">IDCF (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/openssl.html">OpenSSL (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/devops.html">DevOps (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/idcfクラウド.html">IDCFクラウド (10)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/vpn.html">VPN (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/vyos.html">VyOS (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/vpc.html">vpc (4)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/holiday.html">holiday (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/スクリーンショット.html">スクリーンショット (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/スクロール.html">スクロール (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/chrome拡張機能.html">chrome拡張機能 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/jquery.html">jQuery (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/validation.html">Validation (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/route53.html">route53 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/子供乗せ自転車.html">子供乗せ自転車 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/ヘルスファースト.html">ヘルスファースト (3)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/発酵.html">発酵 (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/醤.html">醤 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/講座.html">講座 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/javascript.html">javascript (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/facebook.html">facebook (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/blog.html">blog (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/ogp.html">OGP (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/open-graph-protocol.html">Open Graph protocol (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/エッセンシャルオイル.html">エッセンシャルオイル (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/dottera.html">dottera (2)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/ミネラル.html">ミネラル (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/甘酒講座.html">甘酒講座 (1)</a></i></li><li> <i class="fa fa-tag"><a href="/tags/centos.html">CentOS (1)</a></i></li></ol></fieldset><fieldset><h2>アーカイブ</h2><ol><li> <i class="fa fa-calendar"><a href="/2016.html">2016 (47)</a></i></li><li> <i class="fa fa-calendar"><a href="/2015.html">2015 (3)</a></i></li></ol></fieldset></aside></div><footer><p><i class="fa fa-copyright"></i> <a href="/">Proud Blog</a> - Powerd by <a href="http://www.proudit.jp/">Proudit Inc.</a></p><script src="/javascripts/jquery-3.0.0.min.js"></script><script src="/javascripts/facebook.js"></script><script src="/javascripts/google_analytics.js"></script></footer></body></html>